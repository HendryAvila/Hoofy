# SDD-Hoffy Memory Fusion — Proposal

> Generated by [SDD-Hoffy](https://github.com/HendryAvila/sdd-hoffy) | Stage 1: Propose

## Problem Statement

SDD-Hoffy currently guides AI agents through structured spec-driven development, but each session starts from scratch — there's no memory of past decisions, architecture patterns, or lessons learned across projects or sessions. Meanwhile, Engram (a separate MCP server) provides persistent memory for AI agents but has no structured development workflow. Users currently need to run TWO separate MCP servers to get both capabilities, creating friction and missed integration opportunities (e.g., auto-saving architecture decisions from the Clarity Gate, searching past project patterns when starting new ones).

## Target Users

- **AI-assisted developers** who use MCP-compatible AI agents (Claude, Copilot, etc.) and want structured development planning with persistent memory across sessions — they need their AI to remember past decisions without re-explaining context every time
- **Solo developers and small teams** who work on multiple projects and want cross-project learning — they benefit from searching past architecture decisions, design patterns, and gotchas when starting new projects
- **Current SDD-Hoffy users** who already use the pipeline but lose context between sessions — they want Clarity Gate decisions, design rationale, and task progress to persist and be searchable

## Proposed Solution

A single Go binary MCP server that combines SDD-Hoffy's 7-stage spec-driven development pipeline with Engram's SQLite+FTS5 persistent memory system. The tool provides ~20 MCP tools: 8 existing SDD tools + ~12 memory tools (save, search, context, timeline, sessions, stats, etc.). Key integration points: (1) SDD stage completions auto-save compact summaries to memory with topic_key upserts, (2) sdd_get_context gains a detail_level parameter for progressive disclosure, (3) a decision log tool captures architecture decisions in a searchable format. The memory store lives at ~/.sdd-hoffy/memory.db using pure-Go SQLite (no CGO), maintaining static binary builds.

## Out of Scope

- Will NOT include Engram's TUI (Bubbletea terminal UI) — SDD-Hoffy is an MCP server, not an interactive app
- Will NOT include Engram's HTTP API server — communication is strictly via MCP stdio transport
- Will NOT include Engram's Git Sync system — adds complexity, can be added in a future version
- Will NOT modify the existing SDD pipeline stages or Clarity Gate thresholds — the core pipeline is proven and stable
- Will NOT support multiple concurrent projects in the same memory DB — one project context at a time (multi-project search is supported for read-only queries)

## Success Criteria

- All existing SDD-Hoffy tests continue to pass (zero regression)
- Memory tools pass comprehensive tests including FTS5 search, session lifecycle, topic_key upserts, and deduplication
- Binary remains statically compiled (CGO_ENABLED=0) using pure-Go SQLite
- SDD stage completion automatically saves searchable observations to memory
- Cross-session memory retrieval works: start new session → search for past decisions → get relevant context
- Binary size stays under 30MB (current ~8MB + SQLite overhead)

## Open Questions

- Should we keep the memory DB at `~/.sdd-hoffy/memory.db` or allow per-project memory alongside `sdd/sdd.json`?
- Should the memory protocol (system prompt injection telling AI when to save/search) be an MCP prompt, a resource, or injected via server instructions?
- Do we want privacy tag stripping (`<private>` content removal) from Engram, or is it unnecessary for a dev tool?
